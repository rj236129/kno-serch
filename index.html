<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Chat with RJ Services</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background-color: #f4f7fc;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        .chat-container {
            width: 100%;
            height: 90vh;
            max-width: 700px;
            background-color: #ffffff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
        }

        h2 {
            text-align: center;
            color: #333;
            font-size: 24px;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .messages {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 20px;
            padding: 20px;
            background-color: #f9f9f9;
            border-radius: 10px;
            box-shadow: inset 0 0 8px rgba(0, 0, 0, 0.05);
            margin-top: 10px;
        }

        .message {
            padding: 12px;
            margin: 8px 0;
            background: #f1f1f1;
            border-radius: 8px;
            max-width: 80%;
            line-height: 1.5;
            font-size: 16px;
        }

        .user {
            background-color: #e1f5fe;
            align-self: flex-start;
            border-radius: 12px 12px 0 12px;
        }

        .bot {
            background-color: #fff3e0;
            align-self: flex-end;
            border-radius: 12px 12px 12px 0;
        }

        .chat-box {
            display: flex;
            flex-direction: column;
            margin-top: 10px;
        }

        .chat-box input {
            padding: 12px;
            font-size: 16px;
            border: 1px solid #ddd;
            border-radius: 8px;
            margin-bottom: 15px;
            transition: border 0.3s ease;
        }

        .chat-box input:focus {
            border-color: #007bff;
        }

        .chat-box button {
            padding: 12px;
            font-size: 16px;
            background-color: #007bff;
            color: #ffffff;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .chat-box button:hover {
            background-color: #0056b3;
        }

        .loading {
            display: none;
            text-align: center;
            font-size: 20px;
            color: #007bff;
        }

        .loading span {
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
            100% { transform: translateY(0); }
        }

        /* Link Styling */
        a {
            color: #007bff;
            text-decoration: none;
            word-wrap: break-word;
        }

        a:hover {
            text-decoration: underline;
        }

        /* Image Styling for Websites */
        .site-image {
            width: 40px;
            height: 40px;
            margin-right: 10px;
            vertical-align: middle;
        }

        .site-result {
            display: flex;
            align-items: center;
            margin: 10px 0;
        }
    </style>
</head>
<body>

<div class="chat-container">
    <h2>AI Chat with RJ Services</h2>
    <div class="messages" id="messages"></div>
    <div class="loading" id="loading">Searching... <span>...</span></div>
    <div class="chat-box">
        <input type="text" id="userQuery" placeholder="Ask something..." />
        <button onclick="sendQuery()">Send</button>
    </div>
</div>

<script>
const apiKey = 'AIzaSyDqA356euefrQ1MwYape0W8CoDDb7Ihw9Q'; // Replace with your actual Google API key
const cx = '221d48974cb96450a'; // Replace with your actual CSE ID

// Function to handle user queries
function sendQuery() {
    const query = document.getElementById("userQuery").value.trim();
    if (!query) return; // Prevent empty queries

    addMessage(query, "user"); // Display user query
    document.getElementById("userQuery").value = ''; // Clear the input field

    // Show loading indicator
    document.getElementById("loading").style.display = "block";

    // Check if query matches basic concept question
    if (isConceptQuery(query)) {
        handleConceptQuery(query);
    } else {
        // Fetch results from Google Custom Search API
        fetchGoogleResults(query);
    }
}

// Check if query is a basic concept question (like 'What is GST?')
function isConceptQuery(query) {
    const basicQuestions = [
        "what is gst", "what is itr", "how to make", "how to fill", "how to apply", "how to do", "what is pan card"
    ];

    return basicQuestions.some(question => query.toLowerCase().includes(question));
}

// Handle basic concept queries (e.g., GST, PAN Card, ITR)
function handleConceptQuery(query) {
    let responseText = "";
    let links = [];

    if (query.toLowerCase().includes("gst")) {
        responseText = "GST (Goods and Services Tax) is a single tax on the supply of goods and services. It replaces multiple indirect taxes like VAT, service tax, and excise duty. You can apply for GST registration on the official GST portal.";
        links = ["https://www.gst.gov.in/"];
    } else if (query.toLowerCase().includes("itr")) {
        responseText = "ITR (Income Tax Return) is a form used by individuals and entities to report their income and expenses to the Income Tax Department. To file ITR, visit the official Income Tax Department portal.";
        links = ["https://incometaxindiaefiling.gov.in/"];
    } else if (query.toLowerCase().includes("pan card")) {
        responseText = "A PAN (Permanent Account Number) Card is an essential document for individuals and businesses for taxation purposes. You can apply for a new PAN or update your existing PAN card through the official portal.";
        links = ["https://www.onlineservices.nsdl.com/paam/PanLogin.html"];
    } else if (query.toLowerCase().includes("how to make")) {
        responseText = "To create or make something, there are specific websites and instructions based on what you're trying to create. Could you clarify what you're trying to make?";
        links = ["https://www.amazon.in/", "https://www.flipkart.com/"];
    }

    // Send the response and links
    addMessage(responseText, "bot");
    if (links.length > 0) {
        addMessage(`For more details, visit: <a href="${links[0]}" target="_blank">${links[0]}</a>`, "bot");
    }

    // Hide loading indicator
    document.getElementById("loading").style.display = "none";
}

// Google Custom Search API to fetch search results
function fetchGoogleResults(query) {
    fetch(`https://www.googleapis.com/customsearch/v1?q=${query}&key=${apiKey}&cx=${cx}`)
        .then(response => response.json())
        .then(data => {
            document.getElementById("loading").style.display = "none"; // Hide loading indicator
            if (data.items && data.items.length > 0) {
                let governmentLinks = [];
                let privateLinks = [];

                data.items.forEach(item => {
                    if (item.link.includes("gov")) {
                        governmentLinks.push(item);
                    } else {
                        privateLinks.push(item);
                    }
                });

                // Show Government Links first
                governmentLinks.forEach(item => {
                    addMessage(createSiteResult(item, true), "bot");
                });

                // Show Private Links next
                privateLinks.forEach(item => {
                    addMessage(createSiteResult(item), "bot");
                });
            } else {
                addMessage("No results found. Please try again with a more specific query.", "bot");
            }
        })
        .catch(error => {
            console.error("Error fetching search results:", error);
            document.getElementById("loading").style.display = "none";
            addMessage("Sorry, there was an error fetching the results. Please try again.", "bot");
        });
}

// Helper to create the site result HTML
function createSiteResult(item, isGovernment = false) {
    return `<div class="site-result">
                ${isGovernment ? '<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/0e/India_Government_Seal.svg/1200px-India_Government_Seal.svg.png" class="site-image" />' : ''}
                <a href="${item.link}" target="_blank">${item.title}</a>
                <p>${item.snippet}</p>
            </div>`;
}

// Function to add messages to chat
function addMessage(message, type) {
    const messageElement = document.createElement("div");
    messageElement.classList.add("message", type);
    messageElement.innerHTML = message;
    document.getElementById("messages").appendChild(messageElement);
    document.getElementById("messages").scrollTop = document.getElementById("messages").scrollHeight;
}
</script>

</body>
</html>
